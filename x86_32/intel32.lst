     1                                  ;=====================================================================
     2                                  ;
     3                                  ; Author:      Richard Staszkiewicz
     4                                  ; Date:        2021-06-07
     5                                  ; Description: Function filles the given arrays with the coordinates (+) of
     6                                  ;              markers found in given bitmap.
     7                                  ;       ####
     8                                  ;       ####
     9                                  ;   ########
    10                                  ;   #######+
    11                                  ;=====================================================================
    12                                  
    13                                  ;=====================================================================
    14                                  ;===================IMPORTANT ADRESSES ON STACK=======================
    15                                  ; in find_markers & main
    16                                  ; [ebp + 8]		-> unsigned char *bitmap (never changing constant)
    17                                  ; [ebp + 12]	-> unsigned int *x_pos (never changing constant)
    18                                  ; [ebp + 16]	-> unsigned int *y_pos (never changing constant)
    19                                  ;
    20                                  ;
    21                                  ; in find_marker & else:
    22                                  
    23                                  
    24                                  
    25                                  
    26                                  section .text
    27                                  
    28                                  global find_markers
    29                                  find_markers:
    30 00000000 55                          push	ebp					;remember last EBP
    31 00000001 89E5                    	mov		ebp, esp			;adress of new EBP
    32                                  
    33                                  	; begins of data pushing
    34 00000003 B800000000              	mov		eax, 0
    35 00000008 50                      	push	eax					;pushed AMOUNT
    36 00000009 8B450C                  	mov		eax, [ebp + 12]
    37 0000000C 50                      	push	eax					;pushed *USED
    38 0000000D 8B4508                  	mov 	eax, [ebp + 8]
    39 00000010 83C00A                  	add 	eax, 10
    40 00000013 0300                    	add		eax, [eax]
    41                                  
    42                                  
    43                                  	;jmp		main				;call main function (to be implemented in here)
    44                                  
    45 00000015 8B450C                  	mov		eax, [ebp + 12]		;return 0
    46 00000018 89EC                    	mov		esp, ebp			;delete all local variables
    47 0000001A 5D                      	pop		ebp
    48 0000001B C3                      	ret
    49                                  
    50                                  
    51                                  ;============================================
    52                                  ; THE STACK
    53                                  ;============================================
    54                                  ;
    55                                  ; larger addresses
    56                                  ;
    57                                  ;  |             ...               |
    58                                  ;  | parameter - int *y_pos        | EBP+20
    59                                  ;  ---------------------------------
    60                                  ;  | parameter - int *x_pos        | EBP+16
    61                                  ;  ---------------------------------
    62                                  ;  | parameter - char *used        | EBP+12
    63                                  ;  ---------------------------------
    64                                  ;  | parameter - char *bitmap      | EBP+8
    65                                  ;  ---------------------------------
    66                                  ;  | return address (main.cpp)     | EBP+4
    67                                  ;  ---------------------------------
    68                                  ;  | saved ebp                     | EBP, ESP (find markers)
    69                                  ;  ---------------------------------
    70                                  ;  | amount                        | EBP-4
    71                                  ;  ---------------------------------
    72                                  ;  | *used  -> beginning           | EBP-8				EBP+36
    73                                  ;  ---------------------------------
    74                                  ;  | *image -> beginning           | EBP-12				EBP+32
    75                                  ;  ---------------------------------
    76                                  ;  | width  -> const.              | EBP-16				EBP+28
    77                                  ;  ---------------------------------
    78                                  ;  | length -> const.              | EBP-20				EBP+24
    79                                  ;  ---------------------------------
    80                                  ;  | curr_y -> const.              | EBP-24				EBP+20
    81                                  ;  ---------------------------------
    82                                  ;  | curr_x -> const.              | EBP-28				EBP+16
    83                                  ;  ---------------------------------
    84                                  ;  | curr_used -> flex.            | EBP-32				EBP+12
    85                                  ;  ---------------------------------
    86                                  ;  | curr_img -> flex.             | EBP-36				EBP+8
    87                                  ;  ---------------------------------
    88                                  ;  | return address (mainL)        | EBP-40				EBP+4
    89                                  ;  ---------------------------------
    90                                  ;  | saved ebp                     | EBP, ESP (find_marker)
    91                                  ;  ---------------------------------
    92                                  ;  | curr_y -> flex.               | EBP-4
    93                                  ;  ---------------------------------
    94                                  ;  | curr_x -> flex.               | EBP-8
    95                                  ;  ---------------------------------
    96                                  ;  | curr_used -> flex.            | EBP-12
    97                                  ;  ---------------------------------
    98                                  ;  | curr_img -> flex.             | EBP-16
    99                                  ;
   100                                  ; \/                              \/
   101                                  ; \/ the stack grows in this      \/
   102                                  ; \/ direction                    \/
   103                                  ;
   104                                  ; lower addresses
   105                                  ;
   106                                  ;
   107                                  ;============================================
